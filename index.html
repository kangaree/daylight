<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Sunlight</title>
<script type="text/javascript">/*<![CDATA[*/
// TODO automate getting this data somehow

// http://aa.usno.navy.mil/data/docs/RS_OneDay.php

// Convert hours/minutes into minutes (60*hrs+minutes)
//   civil twilight 0453 -> 293
//   sunrise        0526 -> 326
//   sunset         2027 -> 1227
//   end twilight   2100 -> 1260

function init() {
    const vis = document.getElementById('vis');
    vis.width = window.innerWidth;
    vis.height = window.innerHeight;

    const WIDTH = vis.clientWidth;
    const HEIGHT = vis.clientHeight;
    const d = new Date();

    const TOTAL_MINUTES = 1440;
    const twilight = 293;
    const sunrise = 326;
    const sunset = 1227;
    const nightfall = 1260;
    const CURRENT_TIME = 60 * d.getHours() + d.getMinutes();

    const context = vis.getContext('2d');
    context.fillStyle = "rgb(0,0,0)";
    context.fillRect(
        0,
        0,
        twilight * (WIDTH/TOTAL_MINUTES),
        HEIGHT
    );
    context.fillRect(
        nightfall * (WIDTH/TOTAL_MINUTES),
        0,
        (TOTAL_MINUTES-nightfall) * (WIDTH/TOTAL_MINUTES),
        HEIGHT
    );

    context.fillStyle = "rgb(100,100,100)";
    context.fillRect(
        twilight * (WIDTH/TOTAL_MINUTES),
        0,
        (sunrise-twilight) * (WIDTH/TOTAL_MINUTES),
        HEIGHT
    );
    context.fillRect(
        sunset * (WIDTH/TOTAL_MINUTES),
        0,
        (nightfall-sunset) * (WIDTH/TOTAL_MINUTES),
        HEIGHT
    );

    context.fillStyle = "rgb(250,250,210)";
    context.fillRect(
        sunrise * (WIDTH/TOTAL_MINUTES),
        0,
        (sunset-sunrise) * (WIDTH/TOTAL_MINUTES),
        HEIGHT
    );

    context.fillStyle = "rgb(0,0,255)";
    context.fillRect(
        CURRENT_TIME * (WIDTH/TOTAL_MINUTES)-1,
        0,
        3,
        HEIGHT
    );
}
window.addEventListener('load', function() {
    init();
});
</script>

<style>
body, html {
    margin: 0;
    padding: 0;
    overflow: hidden;
    width: 100%;
    height: 100%;
}
canvas {
    display: block;
    width: 100%;
    height: 100%;
}
</style>

</head>
<body>
    <canvas id="vis" width="100%" height="100%" style="border:1px solid #000">
        You need a browser with <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Canvas_element">HTML5 Canvas</a> support
    </canvas>
</body>
</html>